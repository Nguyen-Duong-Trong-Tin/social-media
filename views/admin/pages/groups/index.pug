extends ../../layouts/admin

include ../../mixins/boxTitle
include ../../mixins/boxCreate
include ../../mixins/formSort
include ../../mixins/formSearch
include ../../mixins/formAction
include ../../mixins/pagination

block main
  +boxTitle(pageTitle)

  +boxCreate(`/${admin}/groups/create`)

  form(form-filter)
    label.form-label Filter
    .input-group.mb-3
      select(
        class="form-select"
        name="filter"
      )
        each filterOption in filter.filterOptions
          option(
            value=filterOption.value 
            selected=(filter.filter === filterOption.value)
          ) #{filterOption.title}

  +formSort(sort)

  +formSearch(keyword, "Search by group title...")

  +formAction(`${url.base}/actions?_method=PATCH`, actionOptions)

  table.table
    thead
      tr
        th(scope="col")
          input(
            class="form-check-input"
            type="checkbox"
            name="checkbox-all"
          )
        th(scope="col") #
        th(scope="col") Avatar
        th(scope="col") Title
        th(scope="col") Group topic
        th(scope="col") Status
        th(scope="col") Actions
    tbody
      each group, index in groups
        tr
          th(scope="row")
            input(
              class="form-check-input"
              type="checkbox"
              name="checkbox"
              value=group.id
            )
          th(scope="row") #{((pagination.page - 1) * pagination.limit) + (index + 1)}
          td(style="width: 15%")
            img(class="img-thumbnail" src=group.avatar)
          td #{group.title}
          td #{groupTopics[index].title}
          td
            form(
              method="POST"
              id=group.id
              form-update-status
            )
              select(
                class="form-select"
                name="status"
                required
              )
                option(value="active" selected=(group.status === "active")) Active
                option(value="inactive" selected=(group.status === "inactive")) Inactive
          td
            a(class="btn btn-primary" href=`/${admin}/groups/detail/${group.id}`) Detail 
            a(class="btn btn-warning mx-1" href=`/${admin}/groups/update/${group.id}`) Edit
            form(
              class="d-inline"
              method="POST"
              action=`/${admin}/groups/delete/${group.id}?_method=DELETE`
              form-delete-item
            )
              button.btn.btn-danger Delete
  
  +pagination(url, pagination.page, pagination.maxPage, pagination.limit)