extends ../../layouts/admin

include ../../mixins/boxGoBack
include ../../mixins/boxTitle

block main
  +boxGoBack(`/${admin}/taskGroupSubmissions`)

  +boxTitle(pageTitle)

  form(
    method="POST"
    action=`/${admin}/taskGroupSubmissions/update/${taskGroupSubmission.id}?_method=PATCH`
    enctype="multipart/form-data"
  )
    .mb-3
      label.form-label Title
      input(
        class="form-control"
        name="title"
        value=taskGroupSubmission.title
        required
      )
    .mb-3
      label.form-label Description
      textarea(
        name="description"
        tinymce
      ) #{taskGroupSubmission.description}
    .mb-3
      label.form-label Images
      each image in taskGroupSubmission.images
        .w-50.mb-1
          img(
            class="img-thumbnail"
            src=image
          )
      input(
        class="form-control"
        type="file"
        name="images"
        accept="image/*"
        multiple
        chooseMaxFileQuantity=6
      )
    .mb-3
      label.form-label Videos
      each video in taskGroupSubmission.videos
        .w-50.mb-1
          video(
            width="100%"
            controls
          )
            source(
              type="video/mp4"
              src=video
          )
      input(
        class="form-control"
        type="file"
        name="videos"
        accept="video/mp4,video/x-m4v,video/*"
        multiple
        chooseMaxFileQuantity=6
      )
    .mb-3
      label.form-label Materials
      div.mb-1
        a(
          class="btn btn-primary"
          href=`/${admin}/taskGroupSubmissions/materials/${taskGroupSubmission.id}`
        ) Detail
      input(
        class="form-control"
        type="file"
        name="materials"
        accept=".pdf,.doc,.docx"
        multiple
        chooseMaxFileQuantity=6
      )
    .mb-3
      label.form-label Status
      select(
        class="form-select"
        name="status"
        required
      )
        option(value="active" selected=(taskGroupSubmission.status === "active")) Active
        option(value="inactive" selected=(taskGroupSubmission.status === "inactive")) Inactive
    .mb-3
      label.form-label Owner
      select(
        class="form-select"
        name="userId"
        required
      )
        option(value="") ---
        each user in users
          option(value=user.id selected=(user.id === taskGroupSubmission.createdBy.userId)) #{user.fullName} - #{user.phone}

    .mb-3
      label.form-label Group task
      select(
        class="form-select"
        name="taskGroupId"
        required
      )
        option(value="") ---
        each taskGroup in taskGroups
          option(value=taskGroup.id selected=(taskGroup.id === taskGroupSubmission.taskGroupId)) #{taskGroup.title}
    
    .d-flex.justify-content-center.mb-3
      button.btn.btn-primary Update